!function(){function t(t,o){o=o||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,o.bubbles,o.cancelable,o.detail),e}if("function"==typeof window.CustomEvent)return!1;t.prototype=window.Event.prototype,window.CustomEvent=t}();var DHPopup=window.DHPopup||{};!function(t){DHPopup.timeoutOpen=null,DHPopup.timeoutClose=null,DHPopup.submitting=!1,DHPopup.currentUpdateStats=!1,DHPopup.scrollPopupDisplayed=!1,DHPopup.timerInactivity=0,DHPopup.intervalInactivity=null,DHPopup.tracking=function(t,o,e,p){if(parseInt(dhvcPopupSetting.ga_tracking)){p=p||1;try{"object"==typeof _gaq?_gaq.push(["_trackEvent",t,o,e,p,!1]):"function"==typeof _trackEvent?_trackEvent(t,o,e,p,!1):"function"==typeof __gaTracker?__gaTracker("send","event",t,o,e,p):"function"==typeof ga&&ga("send","event",t,o,e,p)}catch(t){}}},DHPopup.updateStats=function(o,e,p){if(!DHPopup.currentUpdateStats)return DHPopup.currentUpdateStats=!0,t.post(dhvcPopupSetting.ajax_url,{action:"dh_popup_update_stats_ajax",type:p,object_id:o,campaign_id:e,nonce:dhvcPopupSetting.nonce},function(){DHPopup.currentUpdateStats=!1})},DHPopup.initEvents=function(){t('.dh-popup[data-open_type="load"]').length&&t('.dh-popup[data-open_type="load"]').each(function(){var o=t(this);"show"!==DHPopup.getCookies(o.data("id"))&&DHPopup.openPopUp(o)}),t('.dh-popup[data-open_type="scroll"]').length&&t(window).on("scroll",function(){if(!DHPopup.scrollPopupDisplayed){var o=t(document).height()-t(window).height(),e=t(window).scrollTop(),p=parseInt(e/o*100,10);t('.dh-popup[data-open_type="scroll"]').each(function(){var o=t(this);p>=parseInt(o.data("scroll_offset"),10)&&"show"!==DHPopup.getCookies(o.data("id"))&&(DHPopup.openPopUp(o),DHPopup.scrollPopupDisplayed=!0)})}}),t('.dh-popup[data-open_type="inactivity"]').length&&(DHPopup.intervalInactivity&&clearInterval(DHPopup.intervalInactivity),DHPopup.intervalInactivity=setInterval(function(){DHPopup.timerInactivity++,console.log(DHPopup.timerInactivity),t('.dh-popup[data-open_type="inactivity"]').each(function(){var o=t(this);DHPopup.timerInactivity>parseInt(o.data("inactivity_seconds"),10)&&"show"!==DHPopup.getCookies(o.data("id"))&&(console.log("open"),DHPopup.openPopUp(o))}),DHPopup.timerInactivity>parseInt(dhvcPopupSetting.max_inactivity_timer_interval)&&DHPopup.intervalInactivity&&clearInterval(DHPopup.intervalInactivity)},1e3),t(document).on("mousemove",function(t){DHPopup.timerInactivity=0}),t(document).on("keypress",function(t){DHPopup.timerInactivity=0})),t("body").find('[href^="#popup_open_"],[data-popup-open]').each(function(){t(this).on("click",function(o){o.stopPropagation(),o.preventDefault();var e=t(this).data("popup-open");e||(e=(e=(e=t(this).attr("href"))&&e.replace(/.*(?=#[^\s]*$)/,"")).replace("#popup_open_","")),DHPopup.openPopUp("#dh_popup_"+e,!0)})}),t("body").find('.dh_popup_close,[href="#popup_close"]').each(function(){t(this).on("click",function(o){o.stopPropagation(),o.preventDefault(),t.fancybox&&t.fancybox.isOpen&&t.fancybox.close()})}),t("body").find('[href^="#not_show_popup_again_"],[data-not_show_popup_again]').each(function(){t(this).on("click",function(o){o.stopPropagation(),o.preventDefault();var e=t(this).data("not_show_popup_again");e||(e=(e=(e=t(this).attr("href"))&&e.replace(/.*(?=#[^\s]*$)/,"")).replace("#not_show_popup_again_","")),DHPopup.setCookies(e,parseInt(dhvcPopupSetting.interval_show_popup_again)),t.fancybox.close()})})},DHPopup.setCookies=function(t,o){return o=o||"",Cookies.set(dhvcPopupSetting.cookie_prefix+t,"show",{expires:o,path:"/"})},DHPopup.getCookies=function(t){return(!window.dh_popup_preview||!0!==window.dh_popup_preview)&&Cookies.get(dhvcPopupSetting.cookie_prefix+t)},DHPopup.afterShowPopup=function(o){var e=t(o);switch(e.data("open_mode")){case"once-session":DHPopup.setCookies(e.data("id"),0);break;case"once-period":case"once-session":e.attr("data-open_interval")&&DHPopup.setCookies(e.data("id"),parseInt(openinterval))}},DHPopup.getViewport=function(){var t=window,o="inner";return"innerWidth"in window||(o="client",t=document.documentElement||document.body),{width:t[o+"Width"],height:t[o+"Height"]}},DHPopup.updatePopup=function(o){var e=t(o),p=DHPopup.getViewport();parseInt(e.data("hide_mobile"))&&p.width<=767&&t.fancybox.close();var a=e.data("width"),n=e.data("height"),i=Math.min(p.width/a,p.height/n);(i-=.03)>1&&(i=1),parseInt(e.data("disable_responsive"))&&(i=1);var u="";switch(e.data("position")){case"center-bottom":case"center-top":u="translate(-50%,0) ";break;case"left-center":case"right-center":u="translate(0,-50%) ";break;case"center":u="translate(-50%,-50%) "}var r=e.data("position").replace("-"," ");e.closest(".dh-popup__wrap").css({transform:u+"scale("+i+")","-ms-transform":u+"scale("+i+")","-webkit-transform":u+"scale("+i+")","-ms-transform-origin":r,"transform-origin":r,"-webkit-transform-origin":r})},DHPopup.openPopUp=function(o,e){e=e||!1;var p=DHPopup.getViewport(),a=this,n=t(o);if(parseInt(t(o).data("hide_mobile"))&&p.width<=767)t.fancybox.close();else if(void 0!==t.fancybox&&!t.fancybox.isOpen){var i={};"image"===n.data("overlay_type")&&(i.background="url("+n.data("overlay_image")+")");var u={helpers:{overlay:"disable"===n.data("overlay_type")?null:{locked:!1,closeClick:!parseInt(n.data("disable_overlay_click")),showEarly:!1,speedOut:5,css:i}},tpl:{closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"><i class="fancybox-close__line-top"></i><i class="fancybox-close__line-bottom"></i></a>'},width:"auto",openEffect:"none",autoHeight:!0,padding:0,titleShow:!1,arrows:!1,autoCenter:!1,closeBtn:!n.data("hide_close_button"),wrapCSS:"dh-popup__wrap dh-popup__wrap--"+n.data("id")+" dh-popup__wrap--"+n.data("position"),beforeClose:function(){DHPopup.triggerEvent(n,"beforeClosePopup",n)},afterClose:function(){a.timeoutClose&&clearTimeout(a.timeoutClose),DHPopup.triggerEvent(n,"afterClosePopup",n)},beforeShow:function(){var o=n.data("campaign_id")?n.data("campaign_id"):0;DHPopup.updateStats(n.data("id"),o,"impressions"),DHPopup.tracking("popup","open",n.data("id")),n.find(".dh_popup_field__text").each(function(){t(this).val("")}),DHPopup.triggerEvent(n,"beforeOpenPopup",n)},afterShow:function(){DHPopup.afterShowPopup(n);var o=n.data("close_delay");o&&(a.timeoutClose&&clearTimeout(a.timeoutClose),a.timeoutClose=setTimeout(function(){t.fancybox.close()},1e3*parseInt(o,10))),DHPopup.triggerEvent(n,"afterOpenPopup",n)}};u.onUpdate=function(){DHPopup.updatePopup(n)},parseInt(n.data("disable_responsive"))||(u.fitToView=!1,u.autoCenter=!1,u.autoSize=!1,u.autoResize=!1,u.margin=0,u.wrapCSS=u.wrapCSS+" dh_popup_responsive");var r=n.data("open_delay");!1===e&&r?(a.timeoutOpen&&clearTimeout(a.timeoutOpen),a.timeoutOpen=setTimeout(function(){t.fancybox.open(n,u)},1e3*parseInt(r,10))):t.fancybox.open(n,u)}},DHPopup.clearResponse=function(o){var e=t(o);t(".dh_popup_not_valid_tip",e).remove(),e.removeClass("invalid sent failed"),t("[aria-invalid]",e).attr("aria-invalid","false"),t(".dh_popup__form-control",e).removeClass("dh_popup--not-valid")},DHPopup.triggerEvent=function(o,e,p){var a=t(o),n=new CustomEvent("dhpopup"+e,{bubbles:!0,detail:p});a.get(0).dispatchEvent(n),a.trigger("dhpopup:"+e,p)},DHPopup.initSubmit=function(o){var e=t(o);e.on("submit",function(t){return t&&(t.stopPropagation(),t.preventDefault()),DHPopup.submitForm(e),!1})},DHPopup.notValidTip=function(o,e){var p=t(o);t(".dh_popup_not_valid_tip",p.parent()).remove(),t('<span role="alert" class="dh_popup_not_valid_tip"></span>').text(e).appendTo(p.parent())},DHPopup.submitForm=function(o){var e=this;if(e.submitting)return!1;e.submitting=!0;var p=t(o);DHPopup.clearResponse(p);var a=p.serialize(),n=function(o,p,a,n){var i={id:t(o.into).attr("id"),status:o.status};switch(o.status){case"validation_failed":t.each(o.invalidFields,function(o,e){t(".dh_popup_field__group--"+e.field,n).each(function(){DHPopup.notValidTip(this,e.message),t(".dh_popup__form-control",this).addClass("dh_popup--not-valid"),t("[aria-invalid]",this).attr("aria-invalid","true")})}),n.addClass("invalid"),DHPopup.triggerEvent(n,"invalidForm",i);break;case"subscribe_success":"success"===t(o.into).data("close_type")&&(e.timeoutClose&&clearTimeout(e.timeoutClose),e.timeoutClose=setTimeout(function(){t.fancybox.close()},5e3)),DHPopup.setCookies(t(o.into).attr("id"),parseInt(dhvcPopupSetting.interval_show_popup_again));var u=t(o.into).data("redirect_url");""!==u&&(window.location.href=u)}DHPopup.triggerEvent(n,"submitForm",i)};t.ajax({type:"POST",url:dhvcPopupSetting.ajax_url,data:a,dataType:"json"}).done(function(t,o,a){DHPopup.tracking("popup","subscribe",p.closest(".dh-popup").data("id")),n(t,0,0,p),e.submitting=!1}).fail(function(t,o,a){e.submitting=!1,DHPopup.triggerEvent(p,"submitFail",p)})},t("div.dh-popup__inner > form").each(function(){var o=t(this);DHPopup.initSubmit(o)}),t(document).ready(function(){DHPopup.initEvents()})}(jQuery);